function [Y, Ym, K,  g, cc] = discreteLonlyG2(X, Xm,K2, km, kf, d, a, b3, sl, gm, g, N1)
% This is Variation C3


xx = sl;
%w1 = [  0.01, 0.02, 0.05, 0.05, 0.1, 0.5, 0.25, 0.5,1, 0.25, 0.5, 1 ];
%w1 = w1.^0.8;
%N = w1*(Xm(2:13) + X(2:13))';
N = sum(Xm(2:13) + X(2:13));
%w2 = [0.125, fliplr(w1)];
Y = zeros(1,22);
Ym = zeros(1,22);


% death
% if(N1 < 0.5)
% kk = K2(1)/N1;
% else
%   kk = K2(1)/0.5;
%     
% end
N1 = N1 + 0.001;

%K3 = [(K2(1)/N1)^xx(1)/((K2(1)/N1)^xx(1) + xx2(1)^xx(1)), (K2(1)/N1)^xx(2)/((K2(1)/N1)^xx(2) + xx2(2)^xx(2)) ];

%
K3 = [(K2(1)/N1)^3/((K2(1)/N1)^3 + 0.5^3), (K2(1)/N1)^10/((K2(1)/N1)^10 + 0.5^10) ];

%K3 = [(K2(1)/N1)^3.65/((K2(1)/N1)^3.65 + 0.63^3.65), (K2(1)/N1)^11.7/((K2(1)/N1)^11.7 + 0.52^11.7) ];
%K3 = [kk^3.8/(kk^3.8 + 0.61^3.8), kk^12/(kk.^12 + 0.5^12) ];
%K3 = [1, (K2(1)/N1)^15/((K2(1)/N1)^15 + 0.9^15)];

% Death rate for E, L1-4, and P
%d = d.*[  ones(1,11)./(K3+0.8), 1/(K3+0.8)];
 d = d.*ones(1,5);

dm = d;

g = g(1:2).*K3;



% Transition to Larger weight males
gm   = g./gm;


  
% Transition to new class (a,b) = (0.0043,1.61
N2 = N + sum(Xm(14:19) + X(14:19));
cm = km./(1+ (a*N2)^b3);

c = kf./(1+ (a*N2)^b3);
%c2 = c*(N1 + 3*N3)/(N-N2);
%c2 = c*(N-N2)/(N1 + N3/3);

% c2 = c.*sl;
% if c2(1) >1
%     c2(1) = 1;
%     c = [ c2(1) , c, c2(2)];
%     
% elseif c2(2) > 1
%      c2(2) = 1;
%     c = [ c2(1) , c, c2(2)];
% else
% c = [ c2(1) , c, c2(2)];
% end
% 
% 
% 
% c2 = cm.*sl;
% if c2(1) >1
%     c2(1) = 1;
%     cm = [ c2(1) , cm, c2(2)];
%     
% elseif c2(2) > 1
%      c2(2) = 1;
%     cm = [ c2(1) , cm, c2(2)];
% else
% cm = [ c2(1) , cm, c2(2)];
% end
  cm = [ cm cm cm];
  c = [ c c c];


%if N > 0
K = K2(2)*exp(-0.01*N);
%end


%if (K2(1)/N1) > 1.1
 %   c(1) = 1./(1+ (a*N)^b3);
  %  cm(1) = 1./(1+ (a*N)^b3);
%end




% L1_1:   +eggs-L11
Y(2) =  (1-d(1))*X(2)*(1 -c(3) );
Ym(2) =  (1-dm(1))*Xm(2)*(1 -cm(3) );
%%%%
%%%%
%L2_1: + L1_1 -L21 
Y(3) =  (1-d(1))* c(3)* (1-g(1))* X(2) +   (1- d(2))*(X(3)* (1-c(2)  ));
Ym(3) = (1-dm(1))*cm(3)*(1-gm(1))*Xm(2) + (1- dm(2))*(Xm(3)*(1-cm(2) ));
%L2_2: + cL1_2 + gL1_1 -L22
Y(4) =    (1-d(1))*c(3)* g(1)* X(2) +   (1-d(2))*(X(4)* (1- c(3) ));
Ym(4) =  (1-dm(1))*cm(3)*gm(1)*Xm(2) + (1-dm(2))*(Xm(4)*(1- cm(3)));
%%%%
%%%%
%L3_1: + cL2_1 -L3_1
Y(5)  =   (1-d(2))* c(2)* (1-g(1))*X(3) +   (1- d(3))*X(5)*(1-c(1));
Ym(5) =  (1-dm(2))*cm(2)*(1-gm(1))*Xm(3) + (1- dm(3))*Xm(5)*(1-cm(1));
%L3_2: + gL2_1 + cL2_2  -L32
Y(6) =    (1-d(2))*X(3)*  g(1)*c(2) +  ( 1-d(2))*c(3)* (1-g(2) )*X(4) +  (1-d(3))*X(6)* (1-c(2) );
Ym(6) =  (1-dm(2))*Xm(3)*gm(1)*cm(2) + (1-dm(2))*cm(3)*(1-gm(2))*Xm(4)+ (1-dm(3))*Xm(6)*(1-cm(2));
%L3_3: + gL2_2 + cL2_3 -L33
Y(7) =    (1-d(2))* c(3)*g(2)* X(4) +  ( 1-d(3))*X(7)* (1-c(3)  );
Ym(7) =  (1-dm(2))*cm(3)*gm(2)*Xm(4) + (1-dm(3))*Xm(7)*(1-cm(3) );
%%%%
%%%
%L4_1: + cL3_1 - L41
Y(8)  =  (1-d(3) )*c(1) *(1-g(1) )* X(5) +  (1- d(4))*X(8)*(1-c(1)  );
Ym(8) =  (1-dm(3))*cm(1)*(1-gm(1))*Xm(5) + (1-dm(4))*Xm(8)*(1-cm(1));
%L4_2: + gL3_1 + cL32 -L42
Y(9) =   (1- d(3))*X(5)* g(1)* c(1) +   (1-d(3))*c(2)*( 1-g(2) )*X(6) + (1-d(4) )*X(9)*( 1-c(2) );
Ym(9) =  (1-dm(3))*Xm(5)*gm(1)*cm(1) +(1- dm(3))*cm(2)*(1-gm(2))*Xm(6)+ (1-dm(4))*Xm(9)*(1-cm(2));
% L4_3: gL3_2 + L3_3 - L43
Y(10) =   ( 1-d(3))*X(7)*c(3)  + (1-d(3) )*c(2)*g(2)*X(6)   +   (1- d(4))*X(10)* (1-c(3) );
Ym(10) =  (1-dm(3))*Xm(7)*cm(3)+ (1-dm(3))*cm(2)*gm(2)*Xm(6)  + (1-dm(4))*Xm(10)*(1-cm(3));

% times 2
%L4_1: + cL3_1 - L41
 Y(11) =  c(1)* (1-d(3))*X(8);
Ym(11) =  cm(1)*(1-dm(3))*Xm(8);
%L4_2: + gL3_1 + cL32 -L42
 Y(12) =  c(2)* (1-d(3))*X(9);
Ym(12) =  cm(2)*(1-dm(3))*Xm(9);
% L4_3: gL3_2 + L3_3 - L43
Y(13)  = (1-d(3) )*X(10)* c(3);
Ym(13) = (1-dm(3))*Xm(10)*cm(3);
%%%%
%%%%
%%%%
%%%%

% P_1:
Y(14)  = (1-d(4) )*(1-g(1) )*X(11) + (1-d(5) )*X(14)* (1- c(1) );
Ym(14) = (1-dm(4))*(1-gm(1))*Xm(11)+ (1-dm(5))*Xm(14)*(1- cm(1));
% P_2: gL4_1 + cL4_2 - P2
Y(15)  = (1-d(4) )*X(11)* g(1)+ (1-d(4) )*(1-g(2) )*X(12)+   (1-d(5))*X(15)* (1- c(2) );
Ym(15) = (1-dm(4))*Xm(11)*gm(1)+(1-dm(4))*(1-gm(2))*Xm(12)+ (1-dm(5))*Xm(15)*(1- cm(2));
% P_3: gL4_2 + cL4_3- P4
Y(16)  = (1-d(4) )*g(2)* X(12) +  (1-d(4))*X(13) +   (1-d(5))*X(16)*(1- c(3) );
Ym(16) = (1-dm(4))*gm(2)*Xm(12)+ (1-dm(4))*Xm(13) + (1-dm(5))*Xm(16)*(1- cm(3));


% % P_1:
% Y(17) = c(1)*(1-d(5))*X(14);
% % P_2: gL4_1 + cL4_2 - P2
% Y(18) = c(2)*(1-d(5))*X(15);
% % P_3: gL4_2 + cL4_3- P4
% Y(19) = c(3)*(1-d(5))*X(16);

% P_1:
Y(17)  =(1-d(5) )*(c(1)* X(14) + (1-c(1) )*X(17) );
Ym(17) =(1-dm(5))*(cm(1)*Xm(14)+ (1-cm(1))*Xm(17));
% P_2: gL4_1 + cL4_2 - P2
Ym(18)  = (1-dm(5) )*(cm(2)* Xm(15) +   (1-cm(2))*Xm(18));
Y(18)   = (1-d(5))*(c(2)*X(15) + (1-c(2))*X(18));
% P_3: gL4_2 + cL4_3- P4
Ym(19)   = (1-dm(5))*(cm(3)*Xm(16) + (1-cm(3) )* Xm(19));
Y(19)    =  (1-d(5))*(c(3)* X(16) + (1-c(3))*X(19));

% dead, 
Ym(1) = dm(1)*Xm(2) + dm(2)*(Xm(3)+ Xm(4))+ dm(3)*(Xm(5)+ Xm(6)+ Xm(7))+ dm(4)*(Xm(8)+ Xm(9)+ Xm(10))+ dm(5)*(Xm(11)+ Xm(12)+  Xm(13)) + d(1)*X(2) + d(2)*(X(3)  + X(4)) + d(3)*(X(5) + X(6) + X(7)) + d(4)*(X(8) + X(9) + X(10)) + d(5)*(X(11) +  X(12) + X(13)); 

% female adults
% Y(20) =  (1-d(5))*(X(17));
% Y(21) =  (1-d(5))* X(18);
% Y(22) =  (1-d(5))*(X(19));
Y(20) =  c(1)*(1-d(5))*(X(17));
Y(21) =  c(2)*(1-d(5))* X(18);
Y(22) =  c(3)*(1-d(5))*(X(19));

% male adults
Ym(20) = cm(1)*(1-dm(5))*(Xm(17) );
Ym(21) = cm(2)*(1-dm(5))* Xm(18);
Ym(22) =  cm(3)*(1-dm(5))*(Xm(19));
cc = c(1:2);
end